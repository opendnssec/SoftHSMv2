# WIN32 specific notes

Works and checked on Visual Studio 2010 C++ Express, should work
with any Visual Studio 2010 or 2012 Desktop.

OpenSSL in ssl directory at the same level, Botan in btn,
if you want Debug versions you need ssl+dbg and botand.{lib,dll}.
Note openssl.exe should be in the PATH for cryptotest.exe

win32+openssl and win32+botan, flags in config.h, solution file
in softhsm2.

## project list

convarch: internal static library

softhsm2 (main project): softhsm2.dll

keyconv, util: keyconv.exe and util.exe tools

p11test, cryptotest, datamgrtest, handlemgrtest, objstoretest,
sessionmgrtest, slotmgrtest: checking tools

## C4996 "unsafe" functions

fopen
getenv
gmtime
_snprint
sprintf
sscanf
strncpy
strtok
_vsnprintf
vsnprintf
vsprintf

## port summary (_WIN32 stuff)

windows.h included from config.h with some tuning
(so config.h should be included first)

softhsm2.conf.win32
(installed by VS p11test project including in the topdir)

No unistd.h, sys/mman.h, sys/socket.h, etc

sys/time.h -> time.h

/ in file path -> \ (\\ in chars/strings)

__func__ -> __FUNCTION__
(should be _MSC_VER in place of _WIN32?)

wb/rb in fopen for binary files

dlopen & co -> LoadLibrary & co

valloc, mlock, etc -> VirtualAlloc, VirtualLock, etc

threadID -> GetCurrentThreadId

pthread_mutex -> Mutex
(note CreateMutex is now defined by config.h)

sem_* -> Semaphore
(note getvalue doesn't exist with good reasons on WIN32, simulated
inside a critical section)

dirent & co -> _findfirst & co

remove -> _rmdir or _unlink
(WIN32 remove() doesn't handle directories)

fcntl F_SETL & co* -> LockFileEx & co

shell "rm -rf foo" -> cmd.exe "rmdir /s /q foo 2> nul"

syslog -> provided using Event

getopt, getpassphrase -> provided

setenv -> provided using _putenv
